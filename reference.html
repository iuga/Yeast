<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>Step Reference - Yeast</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="A Python data processing engine for modeling or visualization">
<meta name="generator" content="mkdocs-1.1, mkdocs-gitbook-1.0.7">

<link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
<meta name="HandheldFriendly" content="true"/>
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta rel="next" href="" />
<link href="./css/style.min.css" rel="stylesheet">
<link href="extra.css" rel="stylesheet">
<link href="styles.css" rel="stylesheet"> 
</head>

<body>
<div class="book without-summary">
<div class="book-summary">

<nav role="navigation">
<ul class="summary">
<!--
<li>
<a href="." target="_blank" class="custom-link">Yeast</a>
</li>
<li class="divider"></li> -->
<li class="header">Yeast</li>

<li>
<a href="index.html" class="">Home</a>
</li>

<li class="header">Getting Started</li>

<li>
<a href="introduction.html" class="">5 Minute Introduction</a>
</li>

<li>
<a href="selectors.html" class="">Methods for Selecting Variables</a>
</li>

<li>
<a href="transformers.html" class="">Methods for Transforming Variables</a>
</li>

<li>
<a href="aggregations.html" class="">Methods for Groups and Aggregations</a>
</li>

<li>
<a href="merge.html" class="">Join two DataFrames together</a>
</li>

<li class="header">Developers API</li>

<li>
<a href="reference.html" class="active">Step Reference</a>
</li>

<li>
<a href="extensions.html" class="">Custom Steps</a>
</li>

<li>
<a href="roadmap.html" class="">Roadmap</a>
</li>

<li class="header">Examples</li>

<li>
<a href="examples/san_francisco_crime.html" class="">San Francisco Crime</a>
</li>

<!-- <li class="divider"></li> -->



</ul>

</nav>

</div> <!-- end of book-summary -->

<div class="book-body">
<div class="body-inner">
<div class="book-header" role="navigation">

<!-- Title -->
<h1>
<i class="fa fa-circle-o-notch fa-spin"></i>
<a href="." ></a>
</h1>

</div> <!-- end of book-header -->

<div class="page-wrapper" tabindex="-1" role="main">
<div class="page-inner">

<section class="normal markdown-section">



<h1 id="steps-reference">Steps Reference<a class="headerlink" href="#steps-reference" title="Permanent link">&para;</a></h1>
<p>This module exposes a collection of well-tested steps that you can directly use them on your data processing pipelines.</p>
<h4 id="columns-operations">Columns Operations<a class="headerlink" href="#columns-operations" title="Permanent link">&para;</a></h4>
<p>Execute operations over columns or predictors:</p>
<ul>
<li><a href="#selectcolumnsstep">SelectColumnsStep</a> / <a href="#selectcolumnsstep">SelectStep</a>: Select a group of columns</li>
<li><a href="#mutatestep">MutateStep</a>: Create or transform column values</li>
<li><a href="#renamecolumnsstep">RenameColumnsStep</a>: Rename column names</li>
<li><a href="#castcolumnsstep">CastColumnsStep</a> / <a href="#castcolumnsstep">CastStep</a>: Cast the columns data types</li>
<li><a href="#dropcolumnsstep">DropColumnsStep</a>: Drop/Remove columns</li>
<li><a href="#cleancolumnnamesstep">CleanColumnNamesStep</a>: Clean all column names</li>
<li><a href="#replacenastep">ReplaceNAStep</a>: Replace missing values</li>
</ul>
<h4 id="row-operations">Row Operations<a class="headerlink" href="#row-operations" title="Permanent link">&para;</a></h4>
<p>Execute operations over rows or values:</p>
<ul>
<li><a href="#filterrowsstep">FilterRowsStep</a> / <a href="#filterrowsstep">FilterStep</a>: Filter values based on a expression</li>
<li><a href="#sortrowsstep">SortRowsStep</a> / <a href="#sortrowsstep">SortStep</a>: Sort values based on columns</li>
</ul>
<h4 id="aggregations">Aggregations<a class="headerlink" href="#aggregations" title="Permanent link">&para;</a></h4>
<p>Aggregate or Summarize data:</p>
<ul>
<li><a href="#groupbystep">GroupByStep</a>: Group by rows based on columns</li>
<li><a href="#summarizestep">SummarizeStep</a>: Summarize the group by data</li>
<li><a href="#dropduplicaterowsstep">DropDuplicateRowsStep</a> / <a href="#dropduplicaterowsstep">DropDuplicatesStep</a>: Drop duplicate rows</li>
</ul>
<h4 id="imputation">Imputation<a class="headerlink" href="#imputation" title="Permanent link">&para;</a></h4>
<p>Impute missing data:</p>
<ul>
<li><a href="#meanimputestep">MeanImputeStep</a>: Impute numeric data using the mean</li>
</ul>
<h4 id="workflows">WorkFlows<a class="headerlink" href="#workflows" title="Permanent link">&para;</a></h4>
<p>Arrange and merge workflows and recipes</p>
<ul>
<li><a href="#leftjoinstep">LeftJoinStep</a>: Left Join with a DataFrame or Recipe</li>
<li><a href="#rightjoinstep">RightJoinStep</a>: Right Join with a DataFrame or Recipe</li>
<li><a href="#innerjoinstep">InnerJoinStep</a>: Inner Join with a DataFrame or Recipe</li>
<li><a href="#fulljoinstep">FullJoinStep</a>: Full Outer Join with a DataFrame or Recipe</li>
</ul>
<h4 id="extensions">Extensions<a class="headerlink" href="#extensions" title="Permanent link">&para;</a></h4>
<p>Customize Yeast behavior for our project:</p>
<ul>
<li><a href="#customstep">CustomStep</a>: Step to add your own functionality</li>
</ul>
<h1 id="steps-documentation">Steps Documentation<a class="headerlink" href="#steps-documentation" title="Permanent link">&para;</a></h1>
<h2 id="columns-operations_1">Columns Operations<a class="headerlink" href="#columns-operations_1" title="Permanent link">&para;</a></h2>
<h3 id="selectcolumnsstep">SelectColumnsStep<a class="headerlink" href="#selectcolumnsstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>SelectColumnsStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">columns</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Step in charge of keep columns based on their names or selectors</p>
<p>Parameters:</p>
<ul>
<li><code>columns</code>: list of string column names, selectors or combinations to keep
-- <code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;]</span>
<span class="n">SelectColumnsStep</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="c1"># [&#39;B&#39;]</span>

<span class="c1"># [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;]</span>
<span class="n">SelectColumnsStep</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="c1"># [&#39;B&#39;, &#39;C&#39;]</span>

<span class="c1"># [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;]</span>
<span class="n">SelectColumnsStep</span><span class="p">(</span><span class="n">AllNumeric</span><span class="p">())</span>
<span class="c1"># [&#39;B&#39;]</span>

<span class="c1"># [&#39;AA&#39;, &#39;AB&#39;, &#39;C&#39;, &#39;D&#39;]</span>
<span class="n">SelectColumnsStep</span><span class="p">([</span><span class="n">AllMatching</span><span class="p">(</span><span class="s1">&#39;^A&#39;</span><span class="p">),</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="c1"># [&#39;AA&#39;, &#39;AB&#39;, &#39;D&#39;]</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any column does not exist or any column name is invalid.</li>
</ul></div>
</div>
<h2 id="mutatestep">MutateStep<a class="headerlink" href="#mutatestep" title="Permanent link">&para;</a></h2>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>MutateStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">transformers</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Create or transform variables mantaining the number of rows appliyng a list of transformers.
If more than one transformer is passed to a column, they will be executed in order.
New variables overwrite existing variables of the same name.</p>
<p>Parameters:</p>
<ul>
<li><code>transformers</code>: Dictionary of transformers using keys as column names and values as
                  transformers. E.g: <code>{ column_name: Transformer }</code>.
                  It also support lambda functions. E.g: <code>{var : lambda df: df}</code> and a
                  list of transforers (lambda or Transformer: <code>{var: [tx1, tx2, ...]}</code></li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Create a variable using a lambda function</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">MutateStep</span><span class="p">({</span>
        <span class="s1">&#39;total_sales&#39;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">sales</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">fee</span>
    <span class="p">})</span>
<span class="p">])</span>

<span class="c1"># Create or update variables using Transformers</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">MutateStep</span><span class="p">({</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">StrToLower</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">),</span>
        <span class="s2">&quot;uid&quot;</span><span class="p">:</span> <span class="p">:</span> <span class="n">StrToUpper</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">])</span>

<span class="c1"># If the output column is the same as the input column you don&#39;t need to</span>
<span class="c1"># set the column name. The result will be the same</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">MutateStep</span><span class="p">({</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">StrToLower</span><span class="p">(),</span>  <span class="c1"># name will be transformed to lower case</span>
        <span class="s2">&quot;uid&quot;</span><span class="p">:</span> <span class="p">:</span> <span class="n">StrToUpper</span><span class="p">()</span>   <span class="c1"># uid will be transformed to upper case</span>
    <span class="p">})</span>
<span class="p">])</span>

<span class="c1"># Create or update variables using mutiple Transformers</span>
<span class="c1"># You can use Transformers or Lambda functions</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">MutateStep</span><span class="p">({</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="n">StrReplace</span><span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="n">StrToTitle</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="p">]</span>
    <span class="p">})</span>
<span class="p">])</span>

<span class="c1"># Create or update variables using Group Transformers</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="c1"># Create or update a variable</span>
    <span class="n">GroupByStep</span><span class="p">(</span><span class="s1">&#39;client_id&#39;</span><span class="p">),</span>
    <span class="n">MutateStep</span><span class="p">({</span>
        <span class="s2">&quot;row_number&quot;</span><span class="p">:</span> <span class="n">RowNumber</span><span class="p">(),</span>
        <span class="s2">&quot;lag_sales&quot;</span><span class="p">:</span> <span class="n">NumericLag</span><span class="p">(</span><span class="s1">&#39;sales&#39;</span><span class="p">),</span>
        <span class="s2">&quot;lead_sales&quot;</span><span class="p">:</span> <span class="n">NumericLead</span><span class="p">(</span><span class="s1">&#39;sales&#39;</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">])</span>

<span class="c1"># Create or update a variable using a custom function</span>
<span class="k">def</span> <span class="nf">new_variable</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">sales</span> <span class="o">/</span> <span class="mf">1e6</span>

<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">MutateStep</span><span class="p">({</span>
        <span class="s1">&#39;mean_sales&#39;</span><span class="p">:</span> <span class="n">new_variable</span><span class="p">,</span>
    <span class="p">})</span>
<span class="p">])</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastBakeError</code>: If there was an error executing any transformer</li>
<li><code>YeastValidationError</code>: xxx</li>
</ul></div>
</div>
<h3 id="renamecolumnsstep">RenameColumnsStep<a class="headerlink" href="#renamecolumnsstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>RenameColumnsStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">mapping</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Step in charge of renaming columns based on a mapping dictionary.
Columns that don't exist are ignored.</p>
<p>Parameters:</p>
<ul>
<li><code>mapping</code>: rename mapping as { 'old_name': 'new_name', ... }</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="n">RenameColumnsStep</span><span class="p">({</span>
    <span class="s1">&#39;old_column_name&#39;</span><span class="p">:</span> <span class="s1">&#39;new_column_name&#39;</span>
<span class="p">})</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any column old or new is not a string.</li>
</ul></div>
</div>
<h3 id="castcolumnsstep">CastColumnsStep<a class="headerlink" href="#castcolumnsstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>CastColumnsStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">mapping</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Step in charge of casting columns to a type based on a mapping dictionary.</p>
<p>Available Types:</p>
<ul>
<li><code>category</code></li>
<li><code>string</code>, <code>str</code></li>
<li><code>boolean</code>, <code>bool</code></li>
<li><code>integer</code>, <code>int64</code>, <code>int32</code></li>
<li><code>float</code>, <code>float64</code>, <code>float32</code></li>
<li><code>date</code>, <code>datetime</code>, <code>datetime64</code></li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>mapping</code>: Casting mapping as { 'column_name': 'type', ... }</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="n">CastColumnsStep</span><span class="p">({</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span>
    <span class="s1">&#39;year&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
    <span class="s1">&#39;aired&#39;</span><span class="p">:</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
<span class="p">})</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any column or type is not correct.</li>
</ul></div>
</div>
<h3 id="dropcolumnsstep">DropColumnsStep<a class="headerlink" href="#dropcolumnsstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>DropColumnsStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">columns</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Step in charge of drop columns based on their names.</p>
<p>Parameters:</p>
<ul>
<li><code>columns</code>: list of string column names to drop or a selector.</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># DataFrame columns: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;]</span>
<span class="n">DropColumnsStep</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="c1"># DataFrame result columns: [&#39;A&#39;, &#39;D&#39;]</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any column does not exist or any column name is invalid.</li>
</ul></div>
</div>
<h3 id="cleancolumnnamesstep">CleanColumnNamesStep<a class="headerlink" href="#cleancolumnnamesstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>CleanColumnNamesStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">case='snake'</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Step in charge of clean all columns names.</p>
<p>Available cases:</p>
<ul>
<li><code>snake</code> from <code>column Name</code> to <code>column_name</code></li>
<li><code>lower_camel</code> from <code>column Name</code> to <code>columnName</code></li>
<li><code>upper_camel</code> from <code>column Name</code> to <code>ColumnName</code></li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>case</code>: case that will be used on the columns, <code>snake</code> by default.</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># DataFrame columns: [&#39;TheName&#39;, &#39;B&#39;, &#39;the name&#39;, &#39;Other Name&#39;]</span>
<span class="n">CleanColumnNamesStep</span><span class="p">(</span><span class="s1">&#39;snake&#39;</span><span class="p">)</span>
<span class="c1"># DataFrame result columns: [&#39;the_name&#39;, &#39;b&#39;, &#39;the_name&#39;, &#39;other_name&#39;]</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if the case is not available.</li>
</ul></div>
</div>
<h3 id="replacenastep">ReplaceNAStep<a class="headerlink" href="#replacenastep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>ReplaceNAStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">mapping</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">value=0</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Replace missing values</p>
<p>Parameters:</p>
<ul>
<li><code>mapping</code>: replacing mapping as <code>{'column': replacement_value, ...}</code> or string column name.</li>
<li><code>value</code>: value to replace the NAs if mapping is a string column name. Default: <code>0</code></li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Replace NA values in one column</span>
<span class="n">ReplaceNAStep</span><span class="p">(</span><span class="s1">&#39;factor&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Replace NA values on several columns</span>
<span class="n">ReplaceNAStep</span><span class="p">({</span>
    <span class="s1">&#39;factor&#39;</span><span class="p">:</span> <span class="mf">1.00</span><span class="p">,</span>
    <span class="s1">&#39;pending&#39;</span><span class="p">:</span> <span class="mf">0.00</span><span class="p">,</span>
    <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span>
<span class="p">})</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if a column does not exist on the dataframe</li>
</ul></div>
</div>
<h2 id="row-operations_1">Row Operations<a class="headerlink" href="#row-operations_1" title="Permanent link">&para;</a></h2>
<h3 id="filterrowsstep">FilterRowsStep<a class="headerlink" href="#filterrowsstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>FilterRowsStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">expression</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">**kwargs</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Step in charge of filtering out rows based on boolean conditions.</p>
<p>Operators:</p>
<ul>
<li><code>&amp;</code>, <code>|</code>, <code>and</code>, <code>or</code>,  <code>(</code>, <code>)</code></li>
<li><code>in</code>, <code>not in</code>, <code>==</code>, <code>!=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code></li>
<li><code>+</code>, <code>~</code>, <code>not</code></li>
</ul>
<p>Notes:</p>
<ul>
<li>You can refer to column names with spaces or operators by surrounding them in backticks.</li>
<li>You can refer to variables in the environment by prefixing them with an ‘@’ like <code>@a + b</code>.</li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>expression</code>: The query string to evaluate.</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Subset a DataFrame based on a numeric variable</span>
<span class="n">FilterRowsStep</span><span class="p">(</span><span class="s1">&#39;age &gt; 20&#39;</span><span class="p">)</span>

<span class="c1"># Subset a DataFrame based on a categorical / string variable</span>
<span class="n">FilterRowsStep</span><span class="p">(</span><span class="s1">&#39;category == &quot;Sci-Fi&quot;&#39;</span><span class="p">)</span>

<span class="c1"># Subset a DataFrame comparing two columns</span>
<span class="n">FilterRowsStep</span><span class="p">(</span><span class="s1">&#39;seasons &gt; rating&#39;</span><span class="p">)</span>

<span class="c1"># Subset based on Multiple comparisons</span>
<span class="n">FilterRowsStep</span><span class="p">(</span><span class="s1">&#39;(watched == True) and seasons in [2, 7]&#39;</span><span class="p">)</span>

<span class="c1"># Subset referencing local variables inside the filter</span>
<span class="n">was_watched</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">FilterRowsStep</span><span class="p">(</span><span class="s1">&#39;watched == @was_watched&#39;</span><span class="p">)</span>

<span class="c1"># Subset referencing a column name that contain spaces with backtick:</span>
<span class="n">FilterRowsStep</span><span class="p">(</span><span class="s1">&#39;`episode title` == &quot;Hello&quot;&#39;</span><span class="p">)</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if the expression is an empty string.</li>
</ul></div>
</div>
<h3 id="sortrowsstep">SortRowsStep<a class="headerlink" href="#sortrowsstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>SortRowsStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">columns</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">ascending=True</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Step in charge of sorting rows based on columns.</p>
<p>Parameters:</p>
<ul>
<li><code>columns</code>: list of string column names to sort by</li>
<li><code>ascending</code>: boolean flag wo sort ascending vs. descending</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="n">SortRowsStep</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any column does not exist or any column name is invalid.</li>
</ul></div>
</div>
<h3 id="dropduplicaterowsstep">DropDuplicateRowsStep<a class="headerlink" href="#dropduplicaterowsstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>DropDuplicateRowsStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">columns=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">keep='first'</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Step in charge of remove duplicate rows, optionally only considering certain columns.</p>
<p>Parameters:</p>
<ul>
<li><code>columns</code>: list of string column names to look for duplicates or a selector</li>
<li><code>keep</code> (<code>first, last, none</code>): Determines which duplicates (if any) to keep. <code>first</code> : Drop
                                duplicates except for the first occurrence. <code>last</code> : Drop
                                duplicates except for the last occurrence. <code>none</code> : Drop
                                all duplicates.</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Remove duplicates considering all columns, keep the first occurence</span>
<span class="n">DropDuplicatesStep</span><span class="p">()</span>

<span class="c1"># Remove duplicates considering columnc B and C</span>
<span class="n">DropDuplicatesStep</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>

<span class="c1"># Removing duplicates considering all columns starting with id_</span>
<span class="n">DropDuplicatesStep</span><span class="p">(</span><span class="n">AllMatching</span><span class="p">(</span><span class="s1">&#39;^id_&#39;</span><span class="p">),</span> <span class="n">keep</span><span class="o">=</span><span class="s2">&quot;first&quot;</span><span class="p">)</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any column does not exist or any column name is invalid.</li>
</ul></div>
</div>
<h2 id="individual-transformations">Individual Transformations<a class="headerlink" href="#individual-transformations" title="Permanent link">&para;</a></h2>
<h2 id="aggregations_1">Aggregations<a class="headerlink" href="#aggregations_1" title="Permanent link">&para;</a></h2>
<h3 id="groupbystep">GroupByStep<a class="headerlink" href="#groupbystep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>GroupByStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">columns</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Most data operations are done on groups defined by columns.
GroupByStep takes an existing DataFrame and converts it into a Pandas DataFrameGroupBy where
aggregation/summarization/mutation operations are performed "by group".</p>
<p>A groupby operation involves some combination of:
- Splitting the object: <code>GroupByStep()</code>
- Applying functions: <code>SummarizeStep()</code> or <code>MutateStep()</code>
- And combining the results into a DataFrame.</p>
<p>Parameters:</p>
<ul>
<li><code>columns</code>: list of string column names to group by or a selector</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Basic Group By and an Aggregation</span>
<span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">GroupByStep</span><span class="p">([</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]),</span>
    <span class="n">SummarizeStep</span><span class="p">({</span>
        <span class="s1">&#39;average_rating&#39;</span><span class="p">:</span> <span class="n">AggMean</span><span class="p">(</span><span class="s1">&#39;rating&#39;</span><span class="p">),</span>
        <span class="s1">&#39;unique_titles&#39;</span><span class="p">:</span> <span class="n">AggCountDistinct</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">])</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if a column does not exist on the DataFrame</li>
</ul></div>
</div>
<h3 id="summarizestep">SummarizeStep<a class="headerlink" href="#summarizestep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>SummarizeStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">aggregations</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Create one or more numeric variables summarizing the columns of an existing group created by
GroupByStep() resulting in one row in the output for each group. Please refer to the
Aggregations documentation to see the complete list of supported aggregations.
The most used ones are: <code>AggMean</code>, <code>AggMedian</code>, <code>AggCount</code>, <code>AggMax</code>, <code>AggMin</code></p>
<p>Parameters:</p>
<ul>
<li><code>aggregations</code>: dictionary with the aggregations to perform. The key is the new column name
                  where the value is the specification of the aggregation to perform.
                  For example: <code>{'new_column_name': AggMean('column')}</code></li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Basic Summarization on a Group</span>
<span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">GroupByStep</span><span class="p">([</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]),</span>
    <span class="n">SummarizeStep</span><span class="p">({</span>
        <span class="s1">&#39;average_rating&#39;</span><span class="p">:</span> <span class="n">AggMean</span><span class="p">(</span><span class="s1">&#39;rating&#39;</span><span class="p">),</span>
        <span class="s1">&#39;unique_titles&#39;</span><span class="p">:</span> <span class="n">AggCountDistinct</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
    <span class="p">})</span>
<span class="p">])</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: If there was not a GroupByStep before</li>
</ul></div>
</div>
<h2 id="imputation_1">Imputation<a class="headerlink" href="#imputation_1" title="Permanent link">&para;</a></h2>
<h3 id="meanimputestep">MeanImputeStep<a class="headerlink" href="#meanimputestep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>MeanImputeStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">selector</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Impute numeric data using the mean</p>
<p>MeanImputeStep estimates the variable mean from the prepare data then applies the new values
to new data sets using these averages.</p>
<p>Parameters:</p>
<ul>
<li><code>selector</code>: string list of column names or a selector to impute</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Impute the age and size column using the mean from the training set</span>
<span class="n">MeanImputeStep</span><span class="p">([</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">])</span>

<span class="c1"># You can also use selectors:</span>
<span class="n">MeanImputeStep</span><span class="p">(</span><span class="n">AllNumeric</span><span class="p">())</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if a column does not exist</li>
</ul></div>
</div>
<h2 id="workflows_1">Workflows<a class="headerlink" href="#workflows_1" title="Permanent link">&para;</a></h2>
<h3 id="leftjoinstep">LeftJoinStep<a class="headerlink" href="#leftjoinstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>LeftJoinStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">y</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">by=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">df=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Left Join two DataFrames together</p>
<p>Return all rows from <code>x</code>, and all columns from <code>x</code> and <code>y</code>.
Rows in <code>x</code> with no match in <code>y</code> will have NA values in the new columns.
If there are multiple matches between <code>x</code> and <code>y</code> all combinations of the matches
are returned.</p>
<p>Parameters:</p>
<ul>
<li><code>y</code>: DataFrame or Recipe to merge with.</li>
<li><code>by</code>: optional colum name list to merge by. Default: <code>None</code></li>
<li><code>df</code>: optional df to be used as input if <code>y</code> is a Recipe</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Left Join with another DataFrame</span>
<span class="c1"># sales_df and client_df are DataFrames, by argument is optional</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">LeftJoinStep</span><span class="p">(</span><span class="n">sales_df</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
<span class="p">])</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span>

<span class="c1"># Left join with the DataFrame obtained from the execution of a Recipe</span>
<span class="c1"># sales_recipe will be executed using sales_df inside the client_recipe execution</span>
<span class="n">sales_recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">RenameStep</span><span class="p">({</span><span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="s1">&#39;cid&#39;</span><span class="p">})</span>
<span class="p">])</span>

<span class="n">client_recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">LeftJoinStep</span><span class="p">(</span><span class="n">sales_recipe</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;region_id&quot;</span><span class="p">],</span> <span class="n">df</span><span class="o">=</span><span class="n">sales_df</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">client_recipe</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any of the validations is not correct.</li>
</ul></div>
</div>
<h3 id="rightjoinstep">RightJoinStep<a class="headerlink" href="#rightjoinstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>RightJoinStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">y</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">by=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">df=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Right Join two DataFrames together</p>
<p>Return all rows from <code>y</code>, and all columns from <code>x</code> and <code>y</code>. Rows in <code>y</code> with no match in <code>x</code>
will have <code>NA</code> values in the new columns. If there are multiple matches between <code>x</code> and <code>y</code>,
all combinations of the matches are returned.</p>
<p>Parameters:</p>
<ul>
<li><code>y</code>: DataFrame or Recipe to merge with.</li>
<li><code>by</code>: optional colum name list to merge by. Default: <code>None</code></li>
<li><code>df</code>: optional df to be used as input if <code>y</code> is a Recipe</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Right Join with another DataFrame</span>
<span class="c1"># sales_df and client_df are DataFrames, by argument is optional</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">RightJoinStep</span><span class="p">(</span><span class="n">sales_df</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
<span class="p">])</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span>

<span class="c1"># Right join with the DataFrame obtained from the execution of a Recipe</span>
<span class="c1"># sales_recipe will be executed using sales_df inside the client_recipe execution</span>
<span class="n">sales_recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">RenameStep</span><span class="p">({</span><span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="s1">&#39;cid&#39;</span><span class="p">})</span>
<span class="p">])</span>

<span class="n">client_recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">RightJoinStep</span><span class="p">(</span><span class="n">sales_recipe</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;region_id&quot;</span><span class="p">],</span> <span class="n">df</span><span class="o">=</span><span class="n">sales_df</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">client_recipe</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any of the validations is not correct.</li>
</ul></div>
</div>
<h3 id="innerjoinstep">InnerJoinStep<a class="headerlink" href="#innerjoinstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>InnerJoinStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">y</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">by=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">df=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Inner Join two DataFrames together</p>
<p>Return all rows from <code>x</code> where there are matching values in <code>y</code>, and all columns from <code>x</code> and
<code>y</code>. If there are multiple matches between <code>x</code> and <code>y</code>, all combination of the matches are
returned.</p>
<p>Parameters:</p>
<ul>
<li><code>y</code>: DataFrame or Recipe to merge with.</li>
<li><code>by</code>: optional colum name list to merge by. Default: <code>None</code></li>
<li><code>df</code>: optional df to be used as input if <code>y</code> is a Recipe</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Inner Join with another DataFrame</span>
<span class="c1"># sales_df and client_df are DataFrames, by argument is optional</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">InnerJoinStep</span><span class="p">(</span><span class="n">sales_df</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
<span class="p">])</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span>

<span class="c1"># Inner join with the DataFrame obtained from the execution of a Recipe</span>
<span class="c1"># sales_recipe will be executed using sales_df inside the client_recipe execution</span>
<span class="n">sales_recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">RenameStep</span><span class="p">({</span><span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="s1">&#39;cid&#39;</span><span class="p">})</span>
<span class="p">])</span>

<span class="n">client_recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">InnerJoinStep</span><span class="p">(</span><span class="n">sales_recipe</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;region_id&quot;</span><span class="p">],</span> <span class="n">df</span><span class="o">=</span><span class="n">sales_df</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">client_recipe</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any of the validations is not correct.</li>
</ul></div>
</div>
<h3 id="fulljoinstep">FullJoinStep<a class="headerlink" href="#fulljoinstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>FullJoinStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">y</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">by=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">df=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Full Join two DataFrames together</p>
<p>Return all rows and all columns from both <code>x</code> and <code>y</code>.
Where there are not matching values, returns <code>NA</code> for the one missing.</p>
<p>Parameters:</p>
<ul>
<li><code>y</code>: DataFrame or Recipe to merge with.</li>
<li><code>by</code>: optional colum name list to merge by. Default: <code>None</code></li>
<li><code>df</code>: optional df to be used as input if <code>y</code> is a Recipe</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Full Outer Join with another DataFrame</span>
<span class="c1"># sales_df and client_df are DataFrames, by argument is optional</span>
<span class="n">Recipe</span><span class="p">([</span>
    <span class="n">FullJoinStep</span><span class="p">(</span><span class="n">sales_df</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
<span class="p">])</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span>

<span class="c1"># Full Outer join with the DataFrame obtained from the execution of a Recipe</span>
<span class="c1"># sales_recipe will be executed using sales_df inside the client_recipe execution</span>
<span class="n">sales_recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">RenameStep</span><span class="p">({</span><span class="s1">&#39;client_id&#39;</span><span class="p">:</span> <span class="s1">&#39;cid&#39;</span><span class="p">})</span>
<span class="p">])</span>

<span class="n">client_recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">FullJoinStep</span><span class="p">(</span><span class="n">sales_recipe</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;client_id&quot;</span><span class="p">,</span> <span class="s2">&quot;region_id&quot;</span><span class="p">],</span> <span class="n">df</span><span class="o">=</span><span class="n">sales_df</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">client_recipe</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span><span class="o">.</span><span class="n">bake</span><span class="p">(</span><span class="n">client_df</span><span class="p">)</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any of the validations is not correct.</li>
</ul></div>
</div>
<h2 id="extensions_1">Extensions<a class="headerlink" href="#extensions_1" title="Permanent link">&para;</a></h2>
<h3 id="customstep">CustomStep<a class="headerlink" href="#customstep" title="Permanent link">&para;</a></h3>
<div class="autodoc">
<div class="autodoc-signature"><em>class </em><code>yeast.steps.<strong>CustomStep</strong></code><span class="autodoc-punctuation">(</span><em class="autodoc-param">to_prepare=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">to_bake=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">to_validate=None</em><span class="autodoc-punctuation">, </span><em class="autodoc-param">role='all'</em><span class="autodoc-punctuation">)</span></div>
<div class="autodoc-docstring"><p>Custom Step was designed to extend all the power of Yeast Pipelines and cover all scenarios
where the Yeast steps are not adequate. You might need to define your own operations.
You could define your custom transformations, business rules or extend to third-party libraries.
The usage is quite straightforward and designed to avoid spending too much time on the
implementation. It expects between 1 and 3 arguments, all functions and optional:</p>
<ul>
<li><code>to_validate(step, df)</code></li>
<li><code>to_prepare(step, df)</code>: returns <code>df</code></li>
<li><code>to_bake(step, df)</code>: returns <code>df</code></li>
</ul>
<p>Please notice that <code>to_prepare</code> and <code>to_bake</code> must return a <code>DataFrame</code> to continue the pipeline
execution in further steps. <code>CustomStep</code> enables you to structure and document your code and
business rules in Steps that could be shared across Recipes.</p>
<p>Parameters:</p>
<ul>
<li><code>to_validate</code>: perform validations on the data. Raise YeastValidationError on a problem.</li>
<li><code>to_prepare</code>: prepare the step before bake, like train or calculate aggregations.</li>
<li><code>to_bake</code>: execute the bake (processing). This is the core method.</li>
<li><code>role</code>: String name of the role to control baking flows on new data. Default: <code>all</code>.</li>
</ul>
<p>Inline Usage:</p>
<div class="codehilite"><pre><span></span><code><span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="c1"># Custom Business Rules:</span>
    <span class="n">CustomStep</span><span class="p">(</span><span class="n">to_bake</span><span class="o">=</span><span class="k">lambda</span> <span class="n">step</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="p">])</span>
</code></pre></div>


<p>Custom rules:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">my_bake</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="c1"># Calculate total sales or anything you need:</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;total_sales&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fees&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="c1"># Custom Business Rules:</span>
    <span class="n">CustomStep</span><span class="p">(</span><span class="n">to_bake</span><span class="o">=</span><span class="n">my_bake</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div>


<p>Custom Checks and Validations:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">my_validate</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="k">if</span> <span class="s1">&#39;sales&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">YeastValidationError</span><span class="p">(</span><span class="s1">&#39;sales column not found&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;fees&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">YeastValidationError</span><span class="p">(</span><span class="s1">&#39;fees colum not found&#39;</span><span class="p">)</span>

<span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">CustomStep</span><span class="p">(</span><span class="n">to_validate</span><span class="o">=</span><span class="n">my_validate</span><span class="p">,</span> <span class="n">to_bake</span><span class="o">=</span><span class="n">my_bake</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div>


<p>Define the Estimation/Preparation procedure:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">my_preparation</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="n">step</span><span class="o">.</span><span class="n">mean_sales</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">my_bake</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sales_deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">step</span><span class="o">.</span><span class="n">mean_sales</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">CustomStep</span><span class="p">(</span><span class="n">to_prepare</span><span class="o">=</span><span class="n">my_preparation</span><span class="p">,</span> <span class="n">to_bake</span><span class="o">=</span><span class="n">my_bake</span><span class="p">)</span>
<span class="p">])</span>
</code></pre></div>


<p>Creating a custom step inheriting from CustomStep:</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomStep</span><span class="p">(</span><span class="n">CustomStep</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">do_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="c1"># Some validations that could raise YeastValidationError</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">do_prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="c1"># Prepare the step if needed</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">do_bake</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
        <span class="c1"># Logic to process the df</span>
        <span class="k">return</span> <span class="n">df</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="n">recipe</span> <span class="o">=</span> <span class="n">Recipe</span><span class="p">([</span>
    <span class="n">MyCustomStep</span><span class="p">()</span>
<span class="p">])</span>
</code></pre></div>


<p>Raises:</p>
<ul>
<li><code>YeastValidationError</code>: if any of the parameters is defined but not callable.</li>
</ul></div>
</div>


</section>

</div> <!-- end of page-inner -->
</div> <!-- end of page-wrapper -->

</div> <!-- end of body-inner -->

</div> <!-- end of book-body -->
<script src="./js/main.js"></script>
<script src="./js/gitbook.min.js"></script>
<script src="./js/theme.min.js"></script>
</body>
</html>